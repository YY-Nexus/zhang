# 📤 文件上传完成 - 下一步部署指南

**上传状态：** ✅ 99.7% 完成（3.29GB/3.30GB，35859个项目）  
**目标路径：** `/Volume1/Docker`  
**存储配置：** RAID6=V1, RAID1=V2

---

## ✅ 第一步：确认文件上传完成

等待上传100%完成后，确认文件结构：

```
/Volume1/Docker/
├── Dockerfile
├── Dockerfile.nas
├── docker-compose.yml
├── docker-compose.nas.yml
├── package.json
├── pnpm-lock.yaml
├── next.config.mjs
├── public/
│   ├── wedding/        # 照片
│   ├── MP4/           # 视频
│   └── music/          # 音乐
├── components/
├── app/
├── lib/
└── ... (其他项目文件)
```

---

## 🚀 第二步：在TANKS系统中部署

### 方式一：使用Docker Compose（推荐）

#### 1. 打开Docker Manager

1. 登录TANKS系统
2. 打开 **Docker Manager** 应用

#### 2. 创建新项目

1. 点击左侧菜单 **"项目"** (Projects)
2. 点击 **"新建项目"** 或 **"+"** 按钮
3. 配置：
   - **项目名称：** `zhang-wedding`
   - **项目路径：** `/Volume1/Docker/`
   - **Compose文件：** 选择 `docker-compose.nas.yml`

#### 3. 启动项目

1. 点击 **"启动"** 或 **"部署"** 按钮
2. 系统会自动：
   - 构建Docker镜像（使用 `Dockerfile.nas`）
   - 创建并启动容器
   - 配置端口映射（3666:3000）
   - 挂载卷（public目录）

#### 4. 等待构建完成

- 构建时间：约5-10分钟（取决于NAS性能）
- 可以在 **"日志"** 页面查看构建进度

---

### 方式二：手动创建容器（图形化）

#### 1. 构建镜像

1. 点击左侧菜单 **"镜像"** (Images)
2. 点击 **"构建"** 或 **"Build"** 按钮
3. 配置：
   - **名称：** `zhang-wedding-site`
   - **Dockerfile：** `/Volume1/Docker/Dockerfile.nas`
   - **构建上下文：** `/Volume1/Docker/`
4. 点击 **"开始构建"**
5. 等待构建完成

#### 2. 创建容器

1. 点击左侧菜单 **"容器"** (Containers)
2. 点击 **"新建容器"** 或 **"+"**

**配置：**

- **容器名称：** `zhang-wedding-site`
- **镜像：** `zhang-wedding-site:latest`
- **端口映射：** `3666:3000` (TCP)
- **卷挂载：**
  - 源：`/Volume1/Docker/public`
  - 目标：`/app/public`
  - 权限：只读 (ro)
- **环境变量：**
  - `NODE_ENV=production`
  - `PORT=3000`
  - `NEXT_TELEMETRY_DISABLED=1`
- **重启策略：** 除非停止 (unless-stopped)

#### 3. 启动容器

1. 配置完成后点击 **"创建"**
2. 在容器列表中找到 `zhang-wedding-site`
3. 点击 **"启动"** 或 **"▶️"**

---

## ✅ 第三步：验证部署

### 1. 检查容器状态

在 **"总览"** 页面：

- ✅ 容器状态：**"运行中"** (Running)
- ✅ CPU使用：正常（< 10%）
- ✅ 内存使用：正常（< 1GB）

### 2. 查看日志

1. 进入 **"日志"** 页面
2. 选择容器 `zhang-wedding-site`
3. 确认日志显示：

   ```
   ✓ Ready on http://0.0.0.0:3000
   ```

### 3. 访问网站

在浏览器中访问：

- **<http://NAS-IP:3666>**
- 或配置域名后：**<https://zhang.0379.love>**

---

## 🔧 如果遇到问题

### 问题1：构建失败

**检查：**

1. 查看构建日志
2. 确认所有文件已上传
3. 检查存储空间是否充足

**解决：**

- 在 **"镜像"** 页面查看详细错误信息
- 确认 `Dockerfile.nas` 文件存在

### 问题2：容器无法启动

**检查：**

1. 查看容器日志
2. 检查端口3666是否被占用
3. 确认卷挂载路径正确

**解决：**

- 在 **"容器"** 页面查看日志
- 检查端口映射配置

### 问题3：网站无法访问

**检查：**

1. 容器是否运行
2. 端口映射是否正确
3. 防火墙是否开放3666端口

**解决：**

- 在 **"总览"** 页面确认容器状态
- 检查端口配置

---

## 📊 资源监控

在TANKS系统的 **"总览"** 页面可以监控：

- **CPU使用率：** 正常应 < 10%
- **内存使用：** 正常应 < 1GB
- **存储使用：** 项目占用约3.3GB
- **容器状态：** 应显示"运行中"

---

## 🎉 部署完成

部署成功后：

- ✅ 容器运行正常
- ✅ 网站可以访问
- ✅ 所有功能正常（照片、视频、音乐）
- ✅ 可以在TANKS系统中随时管理

**访问地址：** <http://NAS-IP:3666> 或 <https://zhang.0379.love>

---

## 📝 后续管理

### 重启容器

- 容器列表 → 选择容器 → 点击 **"重启"**

### 查看日志

- 容器列表 → 选择容器 → 点击 **"日志"** 标签

### 更新部署

1. 停止容器
2. 重新构建镜像（如果有代码更新）
3. 启动容器

---

**现在可以在TANKS系统中开始部署了！** 🚀
