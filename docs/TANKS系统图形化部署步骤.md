# 🎨 TANKS 系统图形化部署步骤

**适用：** TANKS 系统（Docker Manager 图形界面）

---

## 📋 部署前准备

### 1. 上传项目文件

将项目文件夹上传到 NAS 服务器，建议路径：

```
/volume1/docker/wedding-site/
```

包含以下文件：

- ✅ `Dockerfile.nas` - NAS 优化版 Dockerfile
- ✅ `docker-compose.nas.yml` - Docker Compose 配置
- ✅ `package.json` - 项目依赖
- ✅ `public/` - 静态资源（照片、视频、音乐）
- ✅ 其他项目文件

---

## 🚀 方式一：使用 Docker Compose（最简单）

### 步骤 1：打开 Docker Manager

1. 登录 TANKS 系统
2. 打开 **Docker Manager** 应用

### 步骤 2：创建新项目

1. 点击左侧菜单 **"项目"** (Projects)
2. 点击 **"新建项目"** 或 **"+"** 按钮
3. 项目名称：`zhang-wedding`
4. 项目路径：选择 `/volume1/docker/wedding-site/`

### 步骤 3：配置 Compose 文件

1. 在项目配置中，选择使用 `docker-compose.nas.yml`
2. 或直接点击 **"从文件导入"**，选择 `docker-compose.nas.yml`

### 步骤 4：启动项目

1. 点击 **"启动"** 或 **"部署"** 按钮
2. 等待构建和启动完成
3. 查看日志确认无错误

---

## 🎯 方式二：手动创建容器（图形化）

### 步骤 1：构建镜像

1. 点击左侧菜单 **"镜像"** (Images)
2. 点击 **"构建"** 或 **"Build"** 按钮
3. 配置：
   - **名称：** `zhang-wedding-site`
   - **Dockerfile 路径：** `/volume1/docker/wedding-site/Dockerfile.nas`
   - **构建上下文：** `/volume1/docker/wedding-site/`
4. 点击 **"开始构建"**
5. 等待构建完成（可能需要几分钟）

### 步骤 2：创建容器

1. 点击左侧菜单 **"容器"** (Containers)
2. 点击 **"新建容器"** 或 **"+"** 按钮

#### 配置容器

**基本信息：**

- 容器名称：`zhang-wedding-site`
- 镜像：选择刚构建的 `zhang-wedding-site:latest`

**端口设置：**

- 点击 **"端口映射"** 或 **"Ports"**
- 添加映射：
  - 主机端口：`3666`
  - 容器端口：`3000`
  - 协议：`TCP`

**存储/卷：**

- 点击 **"卷"** 或 **"Volumes"**
- 添加卷：
  - 源路径：`/volume1/docker/wedding-site/public`
  - 目标路径：`/app/public`
  - 权限：选择 **"只读"** (Read Only)

**环境变量：**

- 点击 **"环境变量"** 或 **"Environment"**
- 添加：
  - `NODE_ENV` = `production`
  - `PORT` = `3000`
  - `NEXT_TELEMETRY_DISABLED` = `1`

**重启策略：**

- 选择 **"除非停止"** (unless-stopped)

**资源限制（可选）：**

- CPU 限制：`1.0` 核心
- 内存限制：`1GB`

### 步骤 3：启动容器

1. 配置完成后，点击 **"创建"** 或 **"Create"**
2. 在容器列表中找到 `zhang-wedding-site`
3. 点击 **"启动"** 或 **"▶️"** 按钮
4. 等待容器启动完成

---

## ✅ 验证部署

### 1. 检查容器状态

在 **"总览"** 或 **"容器"** 页面：

- ✅ 容器状态：**"运行中"** (Running)
- ✅ CPU 使用：正常（< 10%）
- ✅ 内存使用：正常（< 1GB）

### 2. 查看日志

1. 点击容器 `zhang-wedding-site`
2. 进入 **"日志"** (Logs) 标签
3. 查看启动日志，确认：
   - ✅ 没有错误信息
   - ✅ 显示 "Ready on <http://0.0.0.0:3000>"

### 3. 访问网站

在浏览器中访问：

- **<http://NAS-IP:3666>**
- 或配置域名后访问：**<https://zhang.0379.love>**

---

## 🔄 更新部署

### 更新代码后

1. **停止容器**

   - 在容器列表中找到 `zhang-wedding-site`
   - 点击 **"停止"** 或 **"⏸️"**

2. **重新构建镜像**（如果有代码更新）

   - 进入 **"镜像"** 页面
   - 选择 `zhang-wedding-site`
   - 点击 **"重新构建"** 或 **"Rebuild"**

3. **启动容器**
   - 在容器列表中找到 `zhang-wedding-site`
   - 点击 **"启动"** 或 **"▶️"**

---

## 📊 监控和管理

### 在 TANKS 系统中可以

1. **查看资源使用**

   - 在 **"总览"** 页面查看 CPU 和内存使用情况

2. **查看日志**

   - 在 **"日志"** 页面查看容器日志

3. **重启容器**

   - 在容器列表点击 **"重启"** 或 **"🔄"**

4. **停止/启动容器**
   - 使用 **"停止"** 和 **"启动"** 按钮

---

## 🔧 常见操作

### 重启容器

1. 容器列表 → 选择容器 → 点击 **"重启"**

### 查看日志

1. 容器列表 → 选择容器 → 点击 **"日志"** 标签

### 修改配置

1. 容器列表 → 选择容器 → 点击 **"编辑"** 或 **"设置"**
2. 修改配置后点击 **"保存"**
3. 重启容器使配置生效

### 删除容器

1. 容器列表 → 选择容器 → 点击 **"删除"** 或 **"🗑️"**
2. 确认删除

---

## 🌐 配置反向代理（可选）

如果需要通过域名访问，在 NAS 系统中配置反向代理：

1. 打开 NAS 的 **反向代理** 或 **Nginx** 配置
2. 添加规则：
   - 域名：`zhang.0379.love`
   - 目标：`http://localhost:3666`
3. 配置 SSL 证书（如需要）

---

## ✅ 部署检查清单

- [ ] 项目文件已上传到 NAS
- [ ] Docker 镜像构建成功
- [ ] 容器创建并配置完成
- [ ] 端口映射正确（3666:3000）
- [ ] 卷挂载正确（public 目录）
- [ ] 环境变量设置正确
- [ ] 容器启动成功
- [ ] 日志无错误
- [ ] 网站可以访问
- [ ] 所有功能正常（照片、视频、音乐）

---

## 🎉 部署完成

部署成功后，您可以在 TANKS 系统中：

- ✅ 随时查看容器状态
- ✅ 监控资源使用
- ✅ 查看日志
- ✅ 重启/停止容器
- ✅ 更新部署

**访问地址：** <http://NAS-IP:3666> 或 <https://zhang.0379.love>

---

**现在可以在 TANKS 系统中开始部署了！** 🚀
